<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <link rel="stylesheet" href="dark-mode.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--gradient-primary);
            min-height: 100vh;
            padding: 0;
            margin: 0;
            scroll-behavior: smooth;
            color: var(--text-primary);
        }
        
        .container {
            width: 100%;
            max-width: none;
            margin: 0;
            background: var(--bg-primary);
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
        }
        
                 .header {
             background: var(--gradient-header);
             color: white;
             padding: 15px;
             text-align: center;
             position: relative;
         }
        
        .home-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-size: 0.9rem;
        }
        
        .home-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
                 .header h1 {
             font-size: 1.5rem;
             margin-bottom: 3px;
             font-weight: 300;
         }
         
         .header p {
             font-size: 0.8rem;
             opacity: 0.9;
         }
        
        .content {
            padding: 20px 15px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        
        .stats-bar {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .stats-number {
            font-size: 2rem;
            font-weight: bold;
            color: #ea4335;
        }
        
        .sort-controls {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 1px solid #2196f3;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .sort-controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s ease;
        }
        
        .sort-controls:hover::before {
            left: 100%;
        }
        
        .sort-controls label {
            font-weight: 600;
            color: #1976d2;
            font-size: 1rem;
            position: relative;
            z-index: 1;
        }
        
        .sort-select {
            background: white;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 0.95rem;
            color: #333;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 1;
            min-width: 200px;
        }
        
        .sort-select:hover {
            border-color: #1976d2;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.2);
            transform: translateY(-1px);
        }
        
        .sort-select:focus {
            outline: none;
            border-color: #1976d2;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }
        
        .random-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            position: relative;
            z-index: 1;
            overflow: hidden;
        }
        
        .random-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .random-btn:hover::before {
            left: 100%;
        }
        
        .random-btn:hover {
            background: linear-gradient(135deg, #ee5a24 0%, #d63031 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 20px rgba(238, 90, 36, 0.4);
        }
        
        .random-btn:active {
            transform: translateY(0) scale(0.98);
        }
        
        .difficult-questions {
            display: grid;
            gap: 20px;
        }
        
        .question-card {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.6s ease-out both;
        }
        
        .question-card:nth-child(1) { animation-delay: 0.1s; }
        .question-card:nth-child(2) { animation-delay: 0.2s; }
        .question-card:nth-child(3) { animation-delay: 0.3s; }
        .question-card:nth-child(4) { animation-delay: 0.4s; }
        .question-card:nth-child(5) { animation-delay: 0.5s; }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .question-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ea4335, #fbbc04, #34a853, #4285f4);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .question-card:hover::before {
            transform: scaleX(1);
        }
        
        .question-card:hover {
            border-color: #ea4335;
            box-shadow: 0 8px 25px rgba(234, 67, 53, 0.15);
            transform: translateY(-3px);
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            gap: 12px;
        }
        
        .question-number {
            background: linear-gradient(135deg, #ea4335 0%, #d63031 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 2px 8px rgba(234, 67, 53, 0.3);
        }
        
        .question-source {
            background: linear-gradient(135deg, #4285f4 0%, #1976d2 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            box-shadow: 0 2px 6px rgba(66, 133, 244, 0.3);
        }
        
        .question-text {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #333;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .answers {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .answer-item {
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
            font-size: 1rem;
            line-height: 1.6;
            transition: all 0.2s ease;
        }
        
        .answer-item:last-child {
            border-bottom: none;
        }
        
        .answer-item:hover {
            background: rgba(66, 133, 244, 0.05);
            padding-left: 10px;
            border-radius: 5px;
        }
        
        .answer-label {
            font-weight: 600;
            color: #4285f4;
            margin-right: 8px;
        }
        
        .question-timestamp {
            font-size: 12px;
            color: #666;
            font-style: italic;
        }
        
        .remove-btn {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.3s ease;
            min-width: 40px;
            flex-shrink: 0;
        }
        
        .remove-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
        }
        
                 /* Quiz functionality styles */
                       .quiz-mode {
                  background: linear-gradient(145deg, #f8f9fa, #ffffff);
                  border-radius: 15px;
                  padding: 25px;
                  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
              }
        
        .quiz-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .quiz-btn {
            background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }
        
        .quiz-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .quiz-btn:hover::before {
            left: 100%;
        }
        
        .quiz-btn:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 20px rgba(66, 133, 244, 0.4);
        }
        
        .quiz-btn:focus {
            outline: 2px solid #2196f3;
            outline-offset: 2px;
        }
        
        .quiz-btn.active {
            background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%);
        }
        
        /* Mobile-friendly floating next button */
        .floating-next-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }
        
        .floating-next-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 25px rgba(76, 175, 80, 0.6);
        }
        
        .floating-next-btn:active {
            transform: translateY(0) scale(0.95);
        }
        
        /* Hide the original next button on mobile */
        @media (max-width: 768px) {
            #nextBtn {
                display: none !important;
            }
            
            .floating-next-btn {
                display: block;
            }
        }
        
        /* Show floating button on desktop when needed */
        @media (min-width: 769px) {
            .floating-next-btn {
                display: none;
            }
        }
        
                 .answer-option {
             display: flex;
             align-items: center;
             padding: 12px 15px;
             margin: 8px -15px;
             background: white;
             border: 2px solid #e0e0e0;
             border-radius: 8px;
             cursor: pointer;
             transition: all 0.3s ease;
             box-shadow: 0 1px 3px rgba(0,0,0,0.1);
         }
        
        .answer-option:hover {
            border-color: #2196f3;
            background: #f5f5f5;
            transform: translateX(2px);
        }
        
        .answer-option:focus-within {
            outline: 2px solid #2196f3;
            outline-offset: 2px;
        }
        

        
        .answer-radio {
            margin-right: 12px;
            transform: scale(1.2);
        }
        
        .answer-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.5;
        }
        

        
                                   .quiz-stats {
              background: white;
              border-radius: 10px;
              padding: 15px;
              margin-bottom: 20px;
              display: flex;
              justify-content: space-between;
              align-items: center;
              box-shadow: 0 2px 10px rgba(0,0,0,0.05);
              border: 1px solid #e9ecef;
          }
        
                 .quiz-stats-number {
             font-weight: bold;
             font-size: 1.1rem;
         }
        
        /* Tab styles */
        .tab-container {
            margin-bottom: 30px;
        }
        
        .tab-buttons {
            display: flex;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 5px;
            margin-bottom: 20px;
        }
        
        .tab-btn {
            flex: 1;
            background: transparent;
            border: none;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            color: #666;
            font-size: 0.9rem;
        }
        
        .tab-btn.active {
            background: white;
            color: #2196f3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2);
        }
        
        .tab-btn:hover:not(.active) {
            background: rgba(33, 150, 243, 0.1);
            color: #2196f3;
        }
        
        .tab-content {
            display: none;
            animation: slideInUp 0.4s ease-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            animation: fadeIn 0.8s ease-out;
        }
        
        .empty-state h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .empty-state p {
            color: #666;
            margin-bottom: 25px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .back-btn {
            display: inline-block;
            background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
            color: white;
            text-decoration: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
        }
        
        .back-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(66, 133, 244, 0.4);
        }
        
        .back-btn:active {
            transform: translateY(0) scale(0.98);
        }
        
        .footer {
            background: #333;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 0.9rem;
        }
        
                 @media (max-width: 768px) {
                           .header {
                  padding: 12px;
              }
              
              .header h1 {
                  font-size: 1.3rem;
                  margin-bottom: 2px;
              }
              
              .header p {
                  font-size: 0.75rem;
              }
             
             .content {
                 padding: 10px 5px;
             }
             
                           .question-header {
                  flex-direction: column;
                  align-items: flex-start;
                  gap: 10px;
              }
             
             .home-btn {
                 top: 8px;
                 left: 8px;
                 padding: 6px 12px;
                 font-size: 0.8rem;
             }
             
             .quiz-controls {
                 flex-direction: column;
             }
             
             .quiz-btn {
                 width: auto;
                 min-width: 120px;
                 margin-bottom: 0;
                 font-size: 0.9rem;
                 padding: 8px 16px;
             }
             
                           .answer-option {
                  padding: 10px 12px;
                  margin: 8px -12px;
              }
             
             .tab-buttons {
                 display: flex;
                 flex-direction: row;
                 gap: 5px;
             }
             
             .tab-btn {
                 margin-bottom: 0;
                 padding: 10px 8px;
                 font-size: 0.8rem;
                 min-width: 0;
             }
             
             .remove-btn {
                 padding: 6px 12px;
                 font-size: 0.8rem;
                 align-self: flex-end;
             }
             
                           .stats-bar {
                  padding: 10px;
                  margin-bottom: 15px;
              }
              
              .stats-number {
                  font-size: 1.5rem;
              }
              
              .quiz-stats {
                  padding: 6px 10px;
                  margin-bottom: 10px;
                  font-size: 0.8rem;
              }
              
                           .quiz-stats-number {
                 font-size: 1rem;
             }
             
             .sort-controls {
                 flex-direction: column;
                 align-items: stretch;
                 gap: 15px;
             }
             
             .sort-controls > div {
                 flex-direction: column;
                 gap: 8px;
             }
             
             .sort-controls label {
                 text-align: center;
             }
             
             .sort-select {
                 width: 100%;
                 text-align: center;
             }
             
             #sourceStats {
                 margin-left: 0 !important;
                 margin-top: 8px;
                 text-align: center;
             }
        }
        
        @media (max-width: 768px) {
            .sort-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
                padding: 15px;
            }
            
            .sort-select {
                min-width: auto;
                width: 100%;
                font-size: 16px; /* Prevent zoom on iOS */
                padding: 12px 15px;
            }
            
            .random-btn {
                width: 100%;
                padding: 12px 20px;
                font-size: 16px;
            }
            
            .question-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .question-number {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
            
            .question-source {
                font-size: 0.7rem;
                padding: 4px 8px;
            }
            
            .question-text {
                font-size: 1rem;
                line-height: 1.6;
            }
            
            .answers {
                padding: 12px;
            }
            
            .answers label {
                padding: 12px;
                font-size: 0.95rem;
                margin-bottom: 8px;
            }
            
            .quiz-controls {
                flex-direction: column;
                gap: 12px;
            }
            
            .quiz-btn {
                width: 100%;
                padding: 15px 20px;
                font-size: 16px;
            }
            
            .quiz-stats {
                flex-direction: column;
                gap: 10px;
                text-align: center;
                padding: 12px;
            }
            
            .quiz-stats-number {
                font-size: 1rem;
            }
            
            .notification {
                right: 10px;
                left: 10px;
                max-width: none;
                transform: translateY(-100px);
            }
            
            .notification.show {
                transform: translateY(0);
            }
            
            .tabs {
                flex-direction: column;
                gap: 5px;
            }
            
            .tab-button {
                padding: 12px 15px;
                font-size: 16px;
            }
            
            .empty-state {
                padding: 40px 20px;
            }
            
            .empty-state h3 {
                font-size: 1.3rem;
            }
            
            .empty-state p {
                font-size: 1rem;
            }
            
            .back-btn {
                width: 100%;
                padding: 15px 20px;
                font-size: 16px;
            }
        }
        
        @media (max-width: 480px) {
            .content {
                padding: 15px 10px;
            }
            
            .header {
                padding: 30px 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 0.9rem;
            }
            
            .question-card {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            .question {
                padding: 15px;
            }
            
            .answers label {
                padding: 10px;
                font-size: 0.9rem;
            }
            
            .sort-controls {
                padding: 12px;
            }
            
            .sort-select {
                padding: 10px 12px;
            }
            
            .random-btn {
                padding: 10px 15px;
            }
            
            .quiz-mode {
                padding: 15px;
            }
            
            .quiz-controls {
                gap: 10px;
            }
            
            .quiz-btn {
                padding: 12px 15px;
            }
            
            .stats-bar {
                padding: 12px;
            }
            
            .part-stats-bar {
                padding: 12px;
            }
            
            .part-stats-content {
                flex-direction: column;
                gap: 8px;
                text-align: center;
            }
            
            .stats-icon {
                font-size: 1.2rem;
            }
            
            .stats-text {
                font-size: 0.9rem;
            }
            
            .stats-number {
                font-size: 1.1rem;
            }
            
            .stats-total {
                font-size: 0.8rem;
            }
        }
        
        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            .question-card:hover {
                transform: none;
            }
            
            .answers label:hover {
                transform: none;
                background: rgba(66, 133, 244, 0.05);
            }
            
            .quiz-link:hover {
                transform: none;
            }
            
            .random-btn:hover {
                transform: none;
            }
            
            .quiz-btn:hover {
                transform: none;
            }
            
            .nav-button:hover {
                transform: none;
            }
            
            .difficult-btn:hover {
                transform: none;
            }
            
            .feature-link:hover {
                transform: none;
            }
            
            .back-btn:hover {
                transform: none;
            }
        }
        
        /* High contrast mode for better accessibility */
        @media (prefers-contrast: high) {
            .question-card {
                border-width: 3px;
            }
            
            .answers label {
                border-width: 3px;
            }
            
            .difficult-btn {
                border: 3px solid #ee5a24;
            }
            
            .quiz-btn {
                border: 3px solid #4285f4;
            }
        }
        
        /* Reduced motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .progress-bar-fill {
                transition: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-btn">üè† Trang ch·ªß</a>
            <h1>üî• C√¢u H·ªèi Kh√≥</h1>
            <p>Danh s√°ch c√°c c√¢u h·ªèi b·∫°n l√† kh√≥ ƒë·ªÉ √¥n t·∫≠p</p>
        </div>
        
        <div class="content">
            <!-- Tab Container -->
            <div class="tab-container">
                <div class="tab-buttons">
                    <button id="listTabBtn" class="tab-btn active" onclick="switchTab('list')">
                        üìã Danh s√°ch c√¢u kh√≥
                    </button>
                    <button id="quizTabBtn" class="tab-btn" onclick="switchTab('quiz')">
                        üéØ Ch·∫ø ƒë·ªô Quiz
                    </button>
                </div>
                
                <!-- Tab 1: Danh s√°ch c√¢u kh√≥ -->
                <div class="tab-content active" id="listTab">
                    <div class="stats-bar">
                        <div class="stats-number" id="totalDifficult">0</div>
                        <div>c√¢u h·ªèi kh√≥</div>
                        <button onclick="clearAllDifficultQuestions()" style="margin-top: 10px; background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 12px;">
                            üóëÔ∏è X√≥a t·∫•t c·∫£ (Debug)
                        </button>
                        <button onclick="clearCacheAndReload()" style="margin-top: 10px; background: #ff9800; color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 12px;">
                            üîÑ Clear Cache & Reload
                        </button>
                        
                    </div>
                    
                                         <div class="sort-controls">
                         <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                             <div>
                                 <label for="filterSelect">L·ªçc theo:</label>
                                 <select id="filterSelect" class="sort-select" onchange="filterDifficultQuestions()">
                                     <option value="all">T·∫•t c·∫£ ph·∫ßn thi</option>
                                     <option value="1-50">Part 1 (Questions 1-50)</option>
                                     <option value="51-100">Part 2 (Questions 51-100)</option>
                                     <option value="101-150">Part 3 (Questions 101-150)</option>
                                     <option value="151-200">Part 4 (Questions 151-200)</option>
                                     <option value="201-250">Part 5 (Questions 201-250)</option>
                                     <option value="251-317">Part 6 (Questions 251-317)</option>
                                 </select>
                                                         </div>
                            <div>
                                <button onclick="randomizeQuestions()" class="random-btn">üé≤ Ng·∫´u nhi√™n</button>
                            </div>
                         </div>
                         <div id="sourceStats" style="font-size: 0.8rem; color: #666; margin-left: auto;">
                             <!-- Source statistics will be shown here -->
                         </div>
                     </div>

                    <div class="difficult-questions" id="difficultQuestionsList">
                        <!-- Questions will be loaded here -->
                    </div>
                    
                    <div class="empty-state" id="emptyState" style="display: none;">
                        <h3>üìö Ch∆∞a c√≥ c√¢u h·ªèi kh√≥ n√†o</h3>
                        <p>B·∫°n ch∆∞a ƒë√°nh d·∫•u c√¢u h·ªèi n√†o l√† kh√≥. H√£y b·∫Øt ƒë·∫ßu l√†m quiz v√† ƒë√°nh d·∫•u nh·ªØng c√¢u h·ªèi b·∫°n g·∫∑p kh√≥ khƒÉn!</p>
                        <a href="index.html" class="back-btn">üè† V·ªÅ trang ch·ªß</a>
                    </div>
                </div>
                
                <!-- Tab 2: Ch·∫ø ƒë·ªô Quiz -->
                <div class="tab-content" id="quizTab">
                    <div class="quiz-mode">
                        <div class="quiz-controls">
                            <button class="quiz-btn" onclick="startQuiz()">‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu Quiz</button>
                            <button class="quiz-btn" onclick="nextQuestion()" id="nextBtn" style="display: none;">‚è≠Ô∏è C√¢u ti·∫øp theo</button>
                            <button class="quiz-btn" onclick="showAnswer()" id="showAnswerBtn" style="display: none;">üëÅÔ∏è Xem ƒë√°p √°n</button>
                            <button class="quiz-btn" onclick="resetQuiz()" id="resetBtn" style="display: none;">üîÑ L√†m l·∫°i</button>
                        </div>
                        
                                                         <div class="quiz-stats" id="quizStats" style="display: none;">
                             <div style="font-size: 0.9rem; flex: 1; text-align: left;">ƒê√£ tr·∫£ l·ªùi: <span class="quiz-stats-number" id="answeredCount">0</span>/<span class="quiz-stats-number" id="totalCount">0</span></div>
                             <div style="font-size: 0.9rem; flex: 1; text-align: right;">ƒê√∫ng: <span class="quiz-stats-number" id="correctCount" style="color: #4caf50;">0</span> | Sai: <span class="quiz-stats-number" id="incorrectCount" style="color: #f44336;">0</span> | Xem: <span class="quiz-stats-number" id="viewedCount" style="color: #ff9800;">0</span></div>
                         </div>
                        
                        <div id="currentQuestion" style="display: none;">
                            <!-- Current question will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        
        <div class="footer">
            <p>¬© 2024 GCP Exam Practice - H·ªçc t·∫≠p hi·ªáu qu·∫£, th√†nh c√¥ng trong k·ª≥ thi!</p>
        </div>
        
        <!-- Mobile-friendly floating next button -->
        <button class="floating-next-btn" onclick="nextQuestion()" id="floatingNextBtn">
            ‚è≠Ô∏è C√¢u ti·∫øp theo
        </button>
    </div>

    <script>
        // Quiz state variables
        let quizData = null;
        let currentQuestionIndex = 0;
        let quizQuestions = [];
        let userAnswers = {};
        let quizStats = {
            answered: 0,
            correct: 0,
            incorrect: 0,
            viewed: 0  // Th√™m tr·∫°ng th√°i xem ƒë√°p √°n
        };
        
        // Quiz data fallback (embedded directly to avoid CORS issues)
        const FALLBACK_QUIZ_DATA = {
            "quizParts": {
                "part1": {
                    "name": "GCP Fundamentals",
                    "startNumber": 1,
                    "endNumber": 50,
                    "total": 50,
                    "correctAnswers": ["C", "B", "A", "C", "D", "D", "D", "A", "D", "A", "A", "C", "D", "B", "B", "B", "D", "B", "A", "D", "A", "D", "D", "A", "A", "C", "B", "B", "A", "B", "A", "C", "A", "C", "B", "C", "D", "B", "B", "A", "B", "B", "D", "C", "C", "D", "A", "C", "D", "A"]
                },
                "part2": {
                    "name": "Compute Engine & Networking",
                    "startNumber": 51,
                    "endNumber": 100,
                    "total": 50,
                    "correctAnswers": ["A", "C", "B", "A", "A", "B", "B", "B", "C", "C", "B", "A", "D", "C", "A", "A", "A", "C", "A", "B", "A", "C", "B", "A", "A", "D", "A", "A", "B", "C", "D", "A", "B", "A", "C", "A", "C", "A", "A", "B", "D", "D", "A", "B", "D", "B", "C", "C", "C", "D"]
                },
                "part3": {
                    "name": "Storage & Databases",
                    "startNumber": 101,
                    "endNumber": 150,
                    "total": 50,
                    "correctAnswers": ["D", "D", "C", "C", "B", "D", "A", "D", "A", "A", "C", "B", "B", "B", "A", "D", "C", "A", "B", "A", "C", "B", "B", "D", "C", "A", "C", "C", "A", "B", "D", "D", "B", "A", "A", "C", "A", "A", "D", "D", "A", "A", "B", "B", "B", "D", "A", "D", "D", "A"]
                },
                                "part4": {
                    "name": "Security & Identity",
                    "startNumber": 151,
                    "endNumber": 200,
                    "total": 50,
                    "correctAnswers": ["A", "D", "B", "D", "D", "C", "B", "C", "A", "A", "B", "B", "B", "D", "D", "B", "D", "C", "A", "B", "A", "C", "C", "D", "D", "A", "B", "D", "A", "A", "C", "C", "C", "B", "A", "A", "C", "B", "A", "C", "B", "D", "B", "B", "C", "B", "A", "A", "B", "C"]
                },
                "part5": {
                    "name": "Monitoring & Analytics",
                    "startNumber": 201,
                    "endNumber": 250,
                    "total": 50,
                    "correctAnswers": ["D", "C", "A", "A", "C", "A", "B", "A", "A", "B", "A", "A", "A", "B", "D", "B", "C", "B", "B", "D", "B", "B", "B", "D", "A", "D", "D", "A", "D", "B", "D", "B", "D", "D", "A", "A", "B", "B", "C", "D", "A", "C", "D", "C", "A", "B", "D", "A", "B", "D"]
                },
                "part6": {
                    "name": "Advanced Topics",
                    "startNumber": 251,
                    "endNumber": 317,
                    "total": 52,
                    "correctAnswers": ["D", "D", "A", "C", "B", "C", "B", "D", "A", "A", "C", "D", "A", "D", "A", "B", "A", "D", "C", "B", "B", "D", "C", "D", "A", "B", "A", "A", "C", "B", "C", "B", "B", "C", "B", "D", "B", "A", "B", "A", "D", "C", "B", "B", "B", "C", "B", "C", "D", "A", "D", "D"]
                }
            }
        };

        // Load quiz data from quiz-data.json
        async function loadQuizData() {
            try {
                console.log('Attempting to load quiz data...');
                const response = await fetch('quiz-data.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                quizData = await response.json();
                console.log('Quiz data loaded successfully:', quizData);
                
                // Validate quiz data structure
                if (!quizData || !quizData.quizParts) {
                    throw new Error('Invalid quiz data structure');
                }
                
                return true;
            } catch (error) {
                console.error('Error loading quiz data:', error);
                console.log('Using fallback quiz data...');
                
                // Use fallback data
                quizData = FALLBACK_QUIZ_DATA;
                console.log('Fallback quiz data loaded:', quizData);
                
                return true;
            }
        }
        
        function getQuestionsFromStorage(key) {
            try {
                const stored = localStorage.getItem(key);
                return stored ? JSON.parse(stored) : [];
            } catch (error) {
                console.error(`Error reading '${key}' from localStorage:`, error);
                return [];
            }
        }

        function getDifficultQuestions() {
            return getQuestionsFromStorage('difficultQuestions');
        }

        function removeDifficultQuestion(questionId) {
            try {
                const questions = getQuestionsFromStorage('difficultQuestions');
                const updatedQuestions = questions.filter(q => q.id !== questionId);
                localStorage.setItem('difficultQuestions', JSON.stringify(updatedQuestions));
                loadDifficultQuestions();
            } catch (error) {
                console.error('Error removing question:', error);
            }
        }
        
        // Function ƒë·ªÉ x√≥a t·∫•t c·∫£ d·ªØ li·ªáu c≈© (debug)
        function clearAllDifficultQuestions() {
            localStorage.removeItem('difficultQuestions');
            loadDifficultQuestions();
            showNotification('üóëÔ∏è ƒê√£ x√≥a t·∫•t c·∫£ c√¢u h·ªèi kh√≥!', 'info');
        }

        // Function ƒë·ªÉ clear cache v√† reload data
        function clearCacheAndReload() {
            try {
                // Clear localStorage
                localStorage.removeItem('difficultQuestions');
                
                // Clear quiz data
                quizData = null;
                
                // Reload quiz data
                loadQuizData().then(() => {
                    loadDifficultQuestions();
                    console.log('Cache cleared and data reloaded');
                });
            } catch (error) {
                console.error('Error clearing cache:', error);
            }
        }



        function formatTimestamp(timestamp) {
            try {
                const date = new Date(timestamp);
                return date.toLocaleString('vi-VN');
            } catch (error) {
                return 'Kh√¥ng x√°c ƒë·ªãnh';
            }
        }

        function getSourceDisplayName(source) {
            const sourceNames = {
                'part1': 'GCP Fundamentals',
                'part2': 'Compute Engine & Networking',
                'part3': 'Storage & Databases',
                'part4': 'Security & Identity',
                'part5': 'Monitoring & Analytics',
                'part6': 'Advanced Topics'
            };
            return sourceNames[source] || source;
        }

        function getRangeDisplayName(range) {
            const rangeNames = {
                '1-50': 'Part 1 (Questions 1-50)',
                '51-100': 'Part 2 (Questions 51-100)',
                '101-150': 'Part 3 (Questions 101-150)',
                '151-200': 'Part 4 (Questions 151-200)',
                '201-250': 'Part 5 (Questions 201-250)',
                '251-317': 'Part 6 (Questions 251-317)'
            };
            return rangeNames[range] || range;
        }

        function updateSourceStats(questions) {
            const sourceStatsElement = document.getElementById('sourceStats');
            if (!sourceStatsElement) return;
            
            if (questions.length === 0) {
                sourceStatsElement.innerHTML = '';
                return;
            }
            
            // Count questions by range
            const rangeCounts = {};
            questions.forEach(question => {
                const questionNum = parseInt(question.questionNumber);
                let range = '';
                
                if (questionNum >= 1 && questionNum <= 50) {
                    range = 'Part 1 (1-50)';
                } else if (questionNum >= 51 && questionNum <= 100) {
                    range = 'Part 2 (51-100)';
                } else if (questionNum >= 101 && questionNum <= 150) {
                    range = 'Part 3 (101-150)';
                } else if (questionNum >= 151 && questionNum <= 200) {
                    range = 'Part 4 (151-200)';
                } else if (questionNum >= 201 && questionNum <= 250) {
                    range = 'Part 5 (201-250)';
                                  } else if (questionNum >= 251 && questionNum <= 317) {
                    range = 'Part 6 (251-317)';
                } else {
                    range = 'Unknown';
                }
                
                rangeCounts[range] = (rangeCounts[range] || 0) + 1;
            });
            
            // Create statistics display
            const statsHtml = Object.entries(rangeCounts)
                .map(([range, count]) => `${range}: ${count}`)
                .join(' | ');
            
            sourceStatsElement.innerHTML = statsHtml;
        }

        function loadDifficultQuestions() {
            const questions = getQuestionsFromStorage('difficultQuestions');
            const container = document.getElementById('difficultQuestionsList');
            const emptyState = document.getElementById('emptyState');
            const totalElement = document.getElementById('totalDifficult');
            
            // Apply filter
            const filterSelect = document.getElementById('filterSelect');
            const filterValue = filterSelect ? filterSelect.value : 'all';
            let filteredQuestions = questions;
            
            if (filterValue !== 'all') {
                // Parse the range (e.g., "1-50" -> start: 1, end: 50)
                const [start, end] = filterValue.split('-').map(num => parseInt(num));
                filteredQuestions = questions.filter(question => {
                    const questionNum = parseInt(question.questionNumber);
                    return questionNum >= start && questionNum <= end;
                });
            }
            
            totalElement.textContent = filteredQuestions.length;
            
            // Update source statistics with filtered questions
            updateSourceStats(filteredQuestions);
            
            if (filteredQuestions.length === 0) {
                container.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }
            
            container.style.display = 'grid';
            emptyState.style.display = 'none';
            
            container.innerHTML = filteredQuestions.map(question => {
                // T·∫°o HTML cho ƒë√°p √°n
                let answersHtml = '';
                if (question.answers && question.answers.length > 0) {
                    answersHtml = `
                                                 <div style="font-weight: bold; margin-bottom: 10px; color: #333;">üìù C√°c ƒë√°p √°n:</div>
                            ${question.answers.map((answer, index) => {
                                const labels = ['A', 'B', 'C', 'D'];
                                const label = labels[index] || (index + 1);
                                
                                // ƒê·∫£m b·∫£o answer kh√¥ng c√≥ label ·ªü ƒë·∫ßu
                                let cleanAnswer = answer;
                                const labelPattern = new RegExp(`^${label}\\.\\s*`);
                                if (labelPattern.test(cleanAnswer)) {
                                    cleanAnswer = cleanAnswer.replace(labelPattern, '');
                                }
                                
                                return `<div class="answer-item">
                                    <span class="answer-label">${label}.</span>
                                    ${cleanAnswer}
                                </div>`;
                            }).join('')}
                        </div>
                    `;
                }
                
                return `
                    <div class="question-card">
                        <div class="question-header">
                            <div class="question-number">C√¢u ${question.questionNumber}</div>
                            <div class="question-source">${getSourceDisplayName(question.source)}</div>
                        </div>
                        <div class="question-text">${question.text}</div>
                        ${answersHtml}
                        <div class="question-timestamp">
                            ƒê√°nh d·∫•u l√∫c: ${formatTimestamp(question.timestamp)}
                        </div>
                        <button class="remove-btn" onclick="removeDifficultQuestion('${question.id}')">
                            üóëÔ∏è X√≥a kh·ªèi danh s√°ch
                        </button>
                    </div>
                `;
            }).join('');
        }

        // Shuffle function for answers
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        

        
        // Quiz functions
        function startQuiz(customQuestions = null) {
            let questionsToQuiz;

            if (customQuestions) {
                // If custom questions are provided, use them directly
                questionsToQuiz = customQuestions;
                // Also update the header to reflect a custom quiz is running
                const headerText = document.querySelector('.header h1');
                if (headerText) {
                    headerText.textContent = 'üìù Quiz T√πy Ch·ªânh';
                }
                const headerSubText = document.querySelector('.header p');
                if (headerSubText) {
                    headerSubText.textContent = `L√†m b√†i ki·ªÉm tra v·ªõi ${customQuestions.length} c√¢u h·ªèi ƒë√£ ch·ªçn.`;
                }
            } else {
                // Otherwise, use the difficult questions with filtering
                const allDifficultQuestions = getQuestionsFromStorage('difficultQuestions');
                const filterSelect = document.getElementById('filterSelect');
                const filterValue = filterSelect ? filterSelect.value : 'all';

                questionsToQuiz = allDifficultQuestions;
                if (filterValue && filterValue !== 'all') {
                    const [start, end] = filterValue.split('-').map(n => parseInt(n, 10));
                    questionsToQuiz = allDifficultQuestions.filter(q => {
                        const num = parseInt(q.questionNumber, 10);
                        return num >= start && num <= end;
                    });
                }
            }

            if (questionsToQuiz.length === 0) {
                showNotification('Kh√¥ng c√≥ c√¢u h·ªèi n√†o ƒë·ªÉ b·∫Øt ƒë·∫ßu quiz!', 'warning');
                return;
            }
            
            // Prepare quiz questions with full data
            quizQuestions = questionsToQuiz.map(q => {
                const questionNumber = parseInt(q.questionNumber);
                
                // Find correct answer from quiz data
                let correctAnswer = null;
                
                // Try to find the correct part based on question number
                if (quizData && quizData.quizParts) {
                    for (const [partKey, partData] of Object.entries(quizData.quizParts)) {
                        if (questionNumber >= partData.startNumber && questionNumber <= partData.endNumber) {
                            let partIndex;
                            
                            // Special handling for Part 6 which has sparse question numbers
                            if (partKey === 'part6') {
                                const part6QuestionMapping = {
                                    251: 0, 252: 1, 253: 2, 254: 3, 255: 4, 256: 5, 257: 6, 258: 7, 259: 8, 260: 9,
                                    261: 10, 262: 11, 263: 12, 264: 13, 265: 14, 266: 15, 267: 16, 268: 17, 269: 18, 270: 19,
                                    271: 20, 272: 21, 273: 22, 274: 23, 275: 24, 276: 25, 277: 26, 278: 27, 279: 28, 280: 29,
                                    281: 30, 282: 31, 283: 32, 284: 33, 285: 34, 286: 35, 287: 36, 288: 37, 289: 38, 290: 39,
                                    291: 40, 292: 41, 293: 42, 295: 43, 297: 44, 300: 45, 301: 46, 303: 47, 305: 48, 311: 49, 312: 50, 317: 51
                                };
                                partIndex = part6QuestionMapping[questionNumber];
                            } else {
                                // For other parts, use the standard calculation
                                partIndex = questionNumber - partData.startNumber;
                            }
                            
                            if (partIndex !== undefined && partIndex >= 0 && partIndex < partData.correctAnswers.length) {
                                correctAnswer = partData.correctAnswers[partIndex];
                                console.log(`Found correct answer for question ${questionNumber}: ${correctAnswer} from part ${partKey} (index ${partIndex})`);
                                break;
                            }
                        }
                    }
                }
                
                if (!correctAnswer) {
                    console.warn(`Could not find correct answer for question ${questionNumber} from source: ${q.source}`);
                }
                
                return {
                    ...q,
                    correctAnswer: correctAnswer
                };
            });
            
            // Reset quiz state
            currentQuestionIndex = 0;
            userAnswers = {};
            quizStats = {
                answered: 0,
                correct: 0,
                incorrect: 0,
                viewed: 0
            };
            
            // Show quiz elements
            const quizStatsElement = document.getElementById('quizStats');
            const nextBtnElement = document.getElementById('nextBtn');
            const showAnswerBtnElement = document.getElementById('showAnswerBtn');
            const resetBtnElement = document.getElementById('resetBtn');
            
                         if (quizStatsElement) quizStatsElement.style.display = 'flex';
            if (nextBtnElement) {
                nextBtnElement.style.display = 'none';
                nextBtnElement.textContent = '‚è≠Ô∏è C√¢u ti·∫øp theo';
                nextBtnElement.onclick = nextQuestion;
            }
            const floatingNextBtnElement = document.getElementById('floatingNextBtn');
            if (floatingNextBtnElement) {
                floatingNextBtnElement.style.display = 'none';
                floatingNextBtnElement.textContent = '‚è≠Ô∏è C√¢u ti·∫øp theo';
                floatingNextBtnElement.onclick = nextQuestion;
            }
            if (showAnswerBtnElement) showAnswerBtnElement.style.display = 'none';
            if (resetBtnElement) resetBtnElement.style.display = 'none';
            
            // Load first question
            loadCurrentQuestion();
            updateQuizStats();
        }
        
        function loadCurrentQuestion(forceShuffle = true) {
            if (currentQuestionIndex >= quizQuestions.length) {
                showQuizResults();
                return;
            }
            
            const question = quizQuestions[currentQuestionIndex];
            const questionDiv = document.getElementById('currentQuestion');
            
            if (!questionDiv) {
                console.error('Question div not found');
                return;
            }
            
            // Create answer options with shuffling support
            const labels = ['A', 'B', 'C', 'D'];
            let answerOptions = [];
            
            // Create answer objects with their original labels
            const answerObjects = question.answers.map((answer, index) => {
                const label = labels[index] || (index + 1);
                let cleanAnswer = answer;
                const labelPattern = new RegExp(`^${label}\\.\\s*`);
                if (labelPattern.test(cleanAnswer)) {
                    cleanAnswer = cleanAnswer.replace(labelPattern, '');
                }
                
                return {
                    label: label,
                    text: cleanAnswer,
                    originalLabel: label, // Store original label for correct answer tracking
                    isCorrect: question.correctAnswer && question.correctAnswer === label
                };
            });
            
            // Only shuffle answers if this is the first time loading this question (not answered yet)
            if (userAnswers[currentQuestionIndex] === undefined) {
                // First time loading - shuffle and store the order
                answerOptions = shuffleArray(answerObjects);
                question.shuffledAnswers = [...answerOptions]; // Store the shuffled order
            } else {
                // When showing feedback, use the stored shuffled order
                answerOptions = question.shuffledAnswers || answerObjects;
            }
            
            // Update isCorrect property after shuffling based on original labels
            answerOptions.forEach(answerObj => {
                answerObj.isCorrect = question.correctAnswer && answerObj.originalLabel === question.correctAnswer;
            });
            
            // Generate HTML for answer options
            const answerOptionsHtml = answerOptions.map((answerObj) => {
                const isSelected = userAnswers[currentQuestionIndex] === answerObj.label;
                const isAnswered = userAnswers[currentQuestionIndex] !== undefined;
                const isCorrect = answerObj.isCorrect;
                const isIncorrect = isAnswered && userAnswers[currentQuestionIndex] === answerObj.label && !isCorrect;
                
                // Apply the same styling logic as individual parts
                let style = '';
                if (isAnswered) {
                    if (isCorrect) {
                        style = 'color: green; font-weight: bold; background-color: rgba(76, 175, 80, 0.1); border-color: #4caf50;';
                    } else if (isIncorrect) {
                        style = 'color: red; font-weight: bold; background-color: rgba(244, 67, 54, 0.1); border-color: #f44336;';
                    }
                }
                
                return `
                    <div class="answer-option" onclick="selectAnswer('${answerObj.label}')" style="${style}">
                        <input type="radio" class="answer-radio" name="answer" value="${answerObj.label}" 
                               ${isSelected ? 'checked' : ''} ${isAnswered ? 'disabled' : ''}>
                        <div class="answer-text">
                            ${answerObj.text}
                        </div>
                    </div>
                `;
            }).join('');
            

            
            questionDiv.innerHTML = `
                <div class="question-card">
                    <div class="question-header">
                        <div class="question-number">C√¢u ${question.questionNumber} (${currentQuestionIndex + 1}/${quizQuestions.length})</div>
                        <div class="question-source">${getSourceDisplayName(question.source)}</div>
                    </div>
                    <div class="question-text">${question.text}</div>
                                         ${answerOptionsHtml}
                </div>
            `;
            
            questionDiv.style.display = 'block';
            
            // Show/hide buttons based on state
            const showAnswerBtnElement = document.getElementById('showAnswerBtn');
            const nextBtnElement = document.getElementById('nextBtn');
            const resetBtnElement = document.getElementById('resetBtn');
            
            if (userAnswers[currentQuestionIndex] !== undefined) {
                if (showAnswerBtnElement) showAnswerBtnElement.style.display = 'none';
                if (currentQuestionIndex < quizQuestions.length - 1) {
                    if (nextBtnElement) nextBtnElement.style.display = 'inline-block';
                } else {
                    if (resetBtnElement) resetBtnElement.style.display = 'inline-block';
                }
            } else {
                if (showAnswerBtnElement) showAnswerBtnElement.style.display = 'inline-block';
                if (nextBtnElement) nextBtnElement.style.display = 'none';
                const floatingNextBtnElement = document.getElementById('floatingNextBtn');
                if (floatingNextBtnElement) floatingNextBtnElement.style.display = 'none';
                if (resetBtnElement) resetBtnElement.style.display = 'none';
            }
        }
        
        function selectAnswer(answer) {
            if (userAnswers[currentQuestionIndex] !== undefined) return; // Already answered
            
            userAnswers[currentQuestionIndex] = answer;
            const question = quizQuestions[currentQuestionIndex];
            
            // Find the correct answer label in the shuffled answers
            let isCorrect = false;
            if (question.shuffledAnswers) {
                // Find the answer object that has the correct original label
                const correctAnswerObj = question.shuffledAnswers.find(obj => obj.originalLabel === question.correctAnswer);
                if (correctAnswerObj) {
                    isCorrect = answer === correctAnswerObj.label;
                }
            } else {
                // Fallback to original logic if no shuffling
                isCorrect = question.correctAnswer && answer === question.correctAnswer;
            }
            
            // Debug: Log ƒë·ªÉ ki·ªÉm tra
            console.log('Selected answer:', answer);
            console.log('Correct answer:', question.correctAnswer);
            console.log('Is correct:', isCorrect);
            console.log('Question:', question);
            console.log('Shuffled answers:', question.shuffledAnswers);
            
            // Th√™m debug chi ti·∫øt cho c√¢u 189 v√† 190
            if (question.questionNumber === '189' || question.questionNumber === '190') {
                console.log(`=== DEBUG FOR QUESTION ${question.questionNumber} ===`);
                console.log('Question number:', question.questionNumber);
                console.log('Correct answer from database:', question.correctAnswer);
                console.log('User selected:', answer);
                console.log('Shuffled answers:', question.shuffledAnswers);
                if (question.shuffledAnswers) {
                    const correctAnswerObj = question.shuffledAnswers.find(obj => obj.originalLabel === question.correctAnswer);
                    console.log('Correct answer object:', correctAnswerObj);
                    console.log('Expected correct label after shuffle:', correctAnswerObj ? correctAnswerObj.label : 'NOT FOUND');
                }
                console.log('=== END DEBUG ===');
            }
            
            if (isCorrect) {
                quizStats.correct++;
            } else {
                quizStats.incorrect++;
            }
            quizStats.answered++;
            
            updateQuizStats();
            
            // Apply the same selection effect as individual parts
            const answerOptions = document.querySelectorAll('.answer-option');
            answerOptions.forEach(option => {
                const radio = option.querySelector('input[type="radio"]');
                if (radio) {
                    const label = option;
                    
                    // Reset all labels first
                    label.style.fontWeight = "normal";
                    label.style.color = "black";
                    label.style.backgroundColor = "transparent";
                    label.style.borderColor = "#e0e0e0";
                    
                    // If this is the selected answer
                    if (radio.value === answer) {
                        if (isCorrect) {
                            label.style.color = "green";
                            label.style.fontWeight = "bold";
                            label.style.backgroundColor = "rgba(76, 175, 80, 0.1)";
                            label.style.borderColor = "#4caf50";
                        } else {
                            label.style.color = "red";
                            label.style.fontWeight = "bold";
                            label.style.backgroundColor = "rgba(244, 67, 54, 0.1)";
                            label.style.borderColor = "#f44336";
                        }
                    }
                    
                    // If this is the correct answer (highlight it even if not selected)
                    if (question.shuffledAnswers) {
                        const correctAnswerObj = question.shuffledAnswers.find(obj => obj.originalLabel === question.correctAnswer);
                        if (correctAnswerObj && radio.value === correctAnswerObj.label) {
                            label.style.color = "green";
                            label.style.fontWeight = "bold";
                            label.style.backgroundColor = "rgba(76, 175, 80, 0.1)";
                            label.style.borderColor = "#4caf50";
                        }
                    } else if (radio.value === question.correctAnswer) {
                        label.style.color = "green";
                        label.style.fontWeight = "bold";
                        label.style.backgroundColor = "rgba(76, 175, 80, 0.1)";
                        label.style.borderColor = "#4caf50";
                    }
                }
            });
            
            // Show next button or results button based on question position
            const nextBtnElement = document.getElementById('nextBtn');
            const floatingNextBtnElement = document.getElementById('floatingNextBtn');
            const showAnswerBtnElement = document.getElementById('showAnswerBtn');
            
            if (currentQuestionIndex < quizQuestions.length - 1) {
                // Not the last question - show next button
                if (nextBtnElement) nextBtnElement.style.display = 'inline-block';
                if (floatingNextBtnElement) floatingNextBtnElement.style.display = 'block';
            } else {
                // Last question - show results button
                if (nextBtnElement) {
                    nextBtnElement.textContent = 'üèÜ Xem k·∫øt qu·∫£';
                    nextBtnElement.onclick = showQuizResults;
                    nextBtnElement.style.display = 'inline-block';
                }
                if (floatingNextBtnElement) {
                    floatingNextBtnElement.textContent = 'üèÜ Xem k·∫øt qu·∫£';
                    floatingNextBtnElement.onclick = showQuizResults;
                    floatingNextBtnElement.style.display = 'block';
                }
            }
            
            if (showAnswerBtnElement) showAnswerBtnElement.style.display = 'none';
        }
        
        function showAnswer() {
            if (userAnswers[currentQuestionIndex] !== undefined) return;
            
            const question = quizQuestions[currentQuestionIndex];
            if (question.correctAnswer) {
                userAnswers[currentQuestionIndex] = question.correctAnswer;
                quizStats.viewed++;  // Thay ƒë·ªïi t·ª´ incorrect sang viewed
                quizStats.answered++;
                
                updateQuizStats();
                
                // Apply the same selection effect as individual parts
                const answerOptions = document.querySelectorAll('.answer-option');
                answerOptions.forEach(option => {
                    const radio = option.querySelector('input[type="radio"]');
                    if (radio) {
                        const label = option;
                        
                        // Reset all labels first
                        label.style.fontWeight = "normal";
                        label.style.color = "black";
                        label.style.backgroundColor = "transparent";
                        label.style.borderColor = "#e0e0e0";
                        
                        // Highlight the correct answer
                        if (question.shuffledAnswers) {
                            const correctAnswerObj = question.shuffledAnswers.find(obj => obj.originalLabel === question.correctAnswer);
                            if (correctAnswerObj && radio.value === correctAnswerObj.label) {
                                label.style.color = "green";
                                label.style.fontWeight = "bold";
                                label.style.backgroundColor = "rgba(76, 175, 80, 0.1)";
                                label.style.borderColor = "#4caf50";
                            }
                        } else if (radio.value === question.correctAnswer) {
                            label.style.color = "green";
                            label.style.fontWeight = "bold";
                            label.style.backgroundColor = "rgba(76, 175, 80, 0.1)";
                            label.style.borderColor = "#4caf50";
                        }
                    }
                });
                
                // Show next button or results button based on question position
                const nextBtnElement = document.getElementById('nextBtn');
                const floatingNextBtnElement = document.getElementById('floatingNextBtn');
                const showAnswerBtnElement = document.getElementById('showAnswerBtn');
                
                if (currentQuestionIndex < quizQuestions.length - 1) {
                    // Not the last question - show next button
                    if (nextBtnElement) nextBtnElement.style.display = 'inline-block';
                    if (floatingNextBtnElement) floatingNextBtnElement.style.display = 'block';
                } else {
                    // Last question - show results button
                    if (nextBtnElement) {
                        nextBtnElement.textContent = 'üèÜ Xem k·∫øt qu·∫£';
                        nextBtnElement.onclick = showQuizResults;
                        nextBtnElement.style.display = 'inline-block';
                    }
                    if (floatingNextBtnElement) {
                        floatingNextBtnElement.textContent = 'üèÜ Xem k·∫øt qu·∫£';
                        floatingNextBtnElement.onclick = showQuizResults;
                        floatingNextBtnElement.style.display = 'block';
                    }
                }
                
                if (showAnswerBtnElement) showAnswerBtnElement.style.display = 'none';
            } else {
                showNotification('Kh√¥ng th·ªÉ x√°c ƒë·ªãnh ƒë√°p √°n ƒë√∫ng cho c√¢u h·ªèi n√†y', 'error');
            }
        }
        
        function nextQuestion() {
            if (currentQuestionIndex < quizQuestions.length - 1) {
                currentQuestionIndex++;
                // Hide floating button when moving to next question
                const floatingNextBtnElement = document.getElementById('floatingNextBtn');
                if (floatingNextBtnElement) floatingNextBtnElement.style.display = 'none';
                loadCurrentQuestion();
            }
        }
        
        function resetQuiz() {
            // Reload quiz questions from current difficult questions list
            const allDifficultQuestions = getDifficultQuestions();
            const filterSelect = document.getElementById('filterSelect');
            const filterValue = filterSelect ? filterSelect.value : 'all';

            let difficultQuestions = allDifficultQuestions;
            if (filterValue && filterValue !== 'all') {
                const [start, end] = filterValue.split('-').map(n => parseInt(n, 10));
                difficultQuestions = allDifficultQuestions.filter(q => {
                    const num = parseInt(q.questionNumber, 10);
                    return num >= start && num <= end;
                });
            }

            if (difficultQuestions.length === 0) {
                showNotification('Kh√¥ng c√≥ c√¢u h·ªèi ph√π h·ª£p v·ªõi b·ªô l·ªçc ƒë·ªÉ l√†m quiz!', 'warning');
                return;
            }
            
            // Prepare quiz questions with full data
            quizQuestions = difficultQuestions.map(q => {
                const questionNumber = parseInt(q.questionNumber);
                
                // Find correct answer from quiz data
                let correctAnswer = null;
                
                // Try to find the correct part based on question number
                if (quizData && quizData.quizParts) {
                    for (const [partKey, partData] of Object.entries(quizData.quizParts)) {
                        if (questionNumber >= partData.startNumber && questionNumber <= partData.endNumber) {
                            const partIndex = questionNumber - partData.startNumber;
                            if (partIndex >= 0 && partIndex < partData.correctAnswers.length) {
                                correctAnswer = partData.correctAnswers[partIndex];
                                console.log(`Found correct answer for question ${questionNumber}: ${correctAnswer} from part ${partKey} (index ${partIndex})`);
                                break;
                            }
                        }
                    }
                }
                
                if (!correctAnswer) {
                    console.warn(`Could not find correct answer for question ${questionNumber} from source: ${q.source}`);
                }
                
                return {
                    ...q,
                    correctAnswer: correctAnswer
                };
            });
            
            // Reset quiz state
            currentQuestionIndex = 0;
            userAnswers = {};
            quizStats = {
                answered: 0,
                correct: 0,
                incorrect: 0,
                viewed: 0
            };
            
            // Reset button text and onclick handler
            const nextBtnElement = document.getElementById('nextBtn');
            const floatingNextBtnElement = document.getElementById('floatingNextBtn');
            if (nextBtnElement) {
                nextBtnElement.textContent = '‚è≠Ô∏è C√¢u ti·∫øp theo';
                nextBtnElement.onclick = nextQuestion;
            }
            if (floatingNextBtnElement) {
                floatingNextBtnElement.textContent = '‚è≠Ô∏è C√¢u ti·∫øp theo';
                floatingNextBtnElement.onclick = nextQuestion;
            }
            
            // Restore original header
            const headerText = document.querySelector('.header h1');
            if (headerText) {
                headerText.textContent = 'üî• C√¢u H·ªèi Kh√≥';
            }
            const headerSubText = document.querySelector('.header p');
            if (headerSubText) {
                headerSubText.textContent = 'Danh s√°ch c√°c c√¢u h·ªèi b·∫°n l√† kh√≥ ƒë·ªÉ √¥n t·∫≠p';
            }
            
            updateQuizStats();
            loadCurrentQuestion();
        }
        
        function showQuizResults() {
            const questionDiv = document.getElementById('currentQuestion');
            const accuracy = quizStats.answered > 0 ? Math.round((quizStats.correct / quizStats.answered) * 100) : 0;
            
            // X·ª≠ l√Ω logic: ch·ªâ gi·ªØ l·∫°i c√¢u h·ªèi sai, x√≥a c√¢u h·ªèi ƒë√∫ng
            const allDifficultQuestions = getDifficultQuestions();
            const questionsToKeep = [];
            const questionsToRemove = [];
            
            // Ph√¢n lo·∫°i c√¢u h·ªèi d·ª±a tr√™n k·∫øt qu·∫£
            quizQuestions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer && question.correctAnswer && userAnswer === question.correctAnswer;
                
                // T√¨m c√¢u h·ªèi trong danh s√°ch c√¢u kh√≥ hi·ªán t·∫°i
                const existingQuestion = allDifficultQuestions.find(q => 
                    q.questionNumber === question.questionNumber && q.source === question.source
                );
                
                if (existingQuestion) {
                    if (isCorrect) {
                        // C√¢u tr·∫£ l·ªùi ƒë√∫ng - s·∫Ω b·ªã x√≥a kh·ªèi danh s√°ch c√¢u kh√≥
                        questionsToRemove.push(existingQuestion);
                    } else {
                        // C√¢u tr·∫£ l·ªùi sai - gi·ªØ l·∫°i trong danh s√°ch c√¢u kh√≥
                        questionsToKeep.push(existingQuestion);
                    }
                }
            });
            
            // C·∫≠p nh·∫≠t danh s√°ch c√¢u h·ªèi kh√≥
            const updatedDifficultQuestions = allDifficultQuestions.filter(q => 
                !questionsToRemove.some(toRemove => 
                    toRemove.questionNumber === q.questionNumber && toRemove.source === q.source
                )
            );
            
            // L∆∞u danh s√°ch m·ªõi
            localStorage.setItem('difficultQuestions', JSON.stringify(updatedDifficultQuestions));
            
            // Hi·ªÉn th·ªã th√¥ng b√°o v·ªÅ s·ªë c√¢u ƒë√£ x√≥a
            const removedCount = questionsToRemove.length;
            const keptCount = questionsToKeep.length;
            
            questionDiv.innerHTML = `
                <div class="question-card">
                    <h3>üéâ K·∫øt qu·∫£ Quiz</h3>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 2rem; font-weight: bold; color: #2196f3; margin-bottom: 10px;">
                            ${accuracy}%
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div>ƒê√£ tr·∫£ l·ªùi: <strong>${quizStats.answered}</strong> / ${quizQuestions.length}</div>
                            <div>ƒê√∫ng: <strong style="color: #4caf50;">${quizStats.correct}</strong></div>
                            <div>Sai: <strong style="color: #f44336;">${quizStats.incorrect}</strong></div>
                            <div>Xem ƒë√°p √°n: <strong style="color: #ff9800;">${quizStats.viewed}</strong></div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #2196f3;">
                            <div style="font-weight: bold; color: #2196f3; margin-bottom: 8px;">üìä C·∫≠p nh·∫≠t danh s√°ch c√¢u kh√≥:</div>
                            <div style="color: #4caf50;">‚úÖ ƒê√£ x√≥a ${removedCount} c√¢u tr·∫£ l·ªùi ƒë√∫ng</div>
                            <div style="color: #f44336;">‚ùå Gi·ªØ l·∫°i ${keptCount} c√¢u tr·∫£ l·ªùi sai</div>
                        </div>
                        <button class="quiz-btn" onclick="resetQuiz()">üîÑ L√†m l·∫°i</button>
                        <button class="quiz-btn" onclick="retryIncorrectAnswers()" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);">üîÑ L√†m l·∫°i c√¢u sai</button>
                        <button class="quiz-btn" onclick="exitQuiz()">üè† Tho√°t Quiz</button>
                    </div>
                </div>
            `;
            
            const nextBtnElement = document.getElementById('nextBtn');
            const showAnswerBtnElement = document.getElementById('showAnswerBtn');
            const resetBtnElement = document.getElementById('resetBtn');
            
            if (nextBtnElement) nextBtnElement.style.display = 'none';
            const floatingNextBtnElement = document.getElementById('floatingNextBtn');
            if (floatingNextBtnElement) floatingNextBtnElement.style.display = 'none';
            if (showAnswerBtnElement) showAnswerBtnElement.style.display = 'none';
            if (resetBtnElement) resetBtnElement.style.display = 'none';
            
            // C·∫≠p nh·∫≠t danh s√°ch c√¢u h·ªèi kh√≥ tr√™n giao di·ªán
            loadDifficultQuestions();
            
            // Hi·ªÉn th·ªã th√¥ng b√°o
            if (removedCount > 0) {
                showNotification(`ƒê√£ x√≥a ${removedCount} c√¢u tr·∫£ l·ªùi ƒë√∫ng kh·ªèi danh s√°ch c√¢u kh√≥!`, 'info');
            }
        }
        
        function retryIncorrectAnswers() {
            // Collect questions that were answered incorrectly
            const incorrectQuestions = [];
            
            quizQuestions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer && question.correctAnswer && userAnswer === question.correctAnswer;
                
                if (!isCorrect) {
                    // Add to incorrect questions list
                    incorrectQuestions.push(question);
                }
            });
            
            if (incorrectQuestions.length === 0) {
                showNotification('Kh√¥ng c√≥ c√¢u h·ªèi n√†o sai ƒë·ªÉ l√†m l·∫°i!', 'info');
                return;
            }
            
            // Start a new quiz with only incorrect questions
            startQuiz(incorrectQuestions);
            
            // Update the header to show this is a retry session
            const headerText = document.querySelector('.header h1');
            if (headerText) {
                headerText.textContent = 'üîÑ L√†m l·∫°i c√¢u sai';
            }
            const headerSubText = document.querySelector('.header p');
            if (headerSubText) {
                headerSubText.textContent = `L√†m l·∫°i ${incorrectQuestions.length} c√¢u h·ªèi ƒë√£ tr·∫£ l·ªùi sai.`;
            }
            
            showNotification(`B·∫Øt ƒë·∫ßu l√†m l·∫°i ${incorrectQuestions.length} c√¢u h·ªèi sai!`, 'info');
        }
        
        function exitQuiz() {
            const currentQuestionElement = document.getElementById('currentQuestion');
            if (currentQuestionElement) {
                currentQuestionElement.style.display = 'none';
            }
            
            // Reset quiz state
            currentQuestionIndex = 0;
            userAnswers = {};
            quizStats = {
                answered: 0,
                correct: 0,
                incorrect: 0,
                viewed: 0
            };
            
            // Hide quiz elements
            const quizStatsElement = document.getElementById('quizStats');
            const nextBtnElement = document.getElementById('nextBtn');
            const showAnswerBtnElement = document.getElementById('showAnswerBtn');
            const resetBtnElement = document.getElementById('resetBtn');
            
            if (quizStatsElement) quizStatsElement.style.display = 'none';
            if (nextBtnElement) {
                nextBtnElement.style.display = 'none';
                nextBtnElement.textContent = '‚è≠Ô∏è C√¢u ti·∫øp theo';
                nextBtnElement.onclick = nextQuestion;
            }
            const floatingNextBtnElement = document.getElementById('floatingNextBtn');
            if (floatingNextBtnElement) {
                floatingNextBtnElement.style.display = 'none';
                floatingNextBtnElement.textContent = '‚è≠Ô∏è C√¢u ti·∫øp theo';
                floatingNextBtnElement.onclick = nextQuestion;
            }
            if (showAnswerBtnElement) showAnswerBtnElement.style.display = 'none';
            if (resetBtnElement) resetBtnElement.style.display = 'none';
            
            // Restore original header
            const headerText = document.querySelector('.header h1');
            if (headerText) {
                headerText.textContent = 'üî• C√¢u H·ªèi Kh√≥';
            }
            const headerSubText = document.querySelector('.header p');
            if (headerSubText) {
                headerSubText.textContent = 'Danh s√°ch c√°c c√¢u h·ªèi b·∫°n l√† kh√≥ ƒë·ªÉ √¥n t·∫≠p';
            }
        }
        
        function updateQuizStats() {
            const answeredElement = document.getElementById('answeredCount');
            const totalElement = document.getElementById('totalCount');
            const correctElement = document.getElementById('correctCount');
            const incorrectElement = document.getElementById('incorrectCount');
            const viewedElement = document.getElementById('viewedCount');
            
            if (answeredElement) answeredElement.textContent = quizStats.answered;
            if (totalElement) totalElement.textContent = quizQuestions.length;
            if (correctElement) correctElement.textContent = quizStats.correct;
            if (incorrectElement) incorrectElement.textContent = quizStats.incorrect;
            if (viewedElement) viewedElement.textContent = quizStats.viewed;
        }
        
        function showNotification(message, type = 'info') {
            // Create a better notification system
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-icon">${type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}</span>
                    <span class="notification-message">${message}</span>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
            `;
            
            // Add styles if not already added
            if (!document.getElementById('notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    .notification {
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        z-index: 1000;
                        max-width: 400px;
                        animation: slideIn 0.3s ease;
                    }
                    .notification-content {
                        display: flex;
                        align-items: center;
                        padding: 12px 16px;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        font-size: 14px;
                    }
                    .notification-error .notification-content {
                        background: #fee;
                        color: #c53030;
                        border: 1px solid #feb2b2;
                    }
                    .notification-warning .notification-content {
                        background: #fffbeb;
                        color: #c05621;
                        border: 1px solid #fbd38d;
                    }
                    .notification-info .notification-content {
                        background: #ebf8ff;
                        color: #2b6cb0;
                        border: 1px solid #bee3f8;
                    }
                    .notification-icon {
                        margin-right: 8px;
                        font-size: 16px;
                    }
                    .notification-close {
                        margin-left: auto;
                        background: none;
                        border: none;
                        font-size: 18px;
                        cursor: pointer;
                        color: inherit;
                        opacity: 0.7;
                    }
                    .notification-close:hover {
                        opacity: 1;
                    }
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    
                    @media (max-width: 768px) {
                        .notification {
                            right: 10px;
                            left: 10px;
                            max-width: none;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
        
        // Function to create test difficult questions data
        function createTestDifficultQuestions() {
            const testQuestions = [
                {
                    questionNumber: "15",
                    source: "part1",
                    text: "What is the primary benefit of using Google Cloud Platform's global infrastructure?",
                    answers: {
                        "A": "Lower costs compared to on-premises solutions",
                        "B": "Faster deployment times for applications",
                        "C": "Reduced latency and improved performance for global users",
                        "D": "Simplified management and monitoring"
                    },
                    correctAnswer: "C",
                    timestamp: new Date().toISOString()
                },
                {
                    questionNumber: "67",
                    source: "part2",
                    text: "Which Google Cloud service provides managed Kubernetes clusters?",
                    answers: {
                        "A": "Compute Engine",
                        "B": "Google Kubernetes Engine (GKE)",
                        "C": "Cloud Run",
                        "D": "App Engine"
                    },
                    correctAnswer: "B",
                    timestamp: new Date(Date.now() - 86400000).toISOString() // 1 day ago
                },
                {
                    questionNumber: "123",
                    source: "part3",
                    text: "What is the main difference between Cloud Storage and Cloud SQL?",
                    answers: {
                        "A": "Cloud Storage is for structured data, Cloud SQL is for unstructured data",
                        "B": "Cloud Storage is object storage, Cloud SQL is relational database",
                        "C": "Cloud Storage is cheaper than Cloud SQL",
                        "D": "Cloud Storage has better performance than Cloud SQL"
                    },
                    correctAnswer: "B",
                    timestamp: new Date(Date.now() - 172800000).toISOString() // 2 days ago
                },
                {
                    questionNumber: "189",
                    source: "part4",
                    text: "Which IAM role provides the most permissions in Google Cloud?",
                    answers: {
                        "A": "Editor",
                        "B": "Viewer",
                        "C": "Owner",
                        "D": "Admin"
                    },
                    correctAnswer: "C",
                    timestamp: new Date(Date.now() - 259200000).toISOString() // 3 days ago
                },
                {
                    questionNumber: "234",
                    source: "part5",
                    text: "What is the purpose of Cloud Monitoring in Google Cloud?",
                    answers: {
                        "A": "To manage user access and permissions",
                        "B": "To monitor and observe applications and infrastructure",
                        "C": "To store and analyze large datasets",
                        "D": "To deploy and scale applications"
                    },
                    correctAnswer: "B",
                    timestamp: new Date(Date.now() - 345600000).toISOString() // 4 days ago
                },
                {
                    questionNumber: "278",
                    source: "part6",
                    text: "Which service is best suited for running serverless containers?",
                    answers: {
                        "A": "Compute Engine",
                        "B": "Cloud Functions",
                        "C": "Cloud Run",
                        "D": "App Engine"
                    },
                    correctAnswer: "C",
                    timestamp: new Date(Date.now() - 432000000).toISOString() // 5 days ago
                }
            ];
            
            // Save to localStorage
            localStorage.setItem('difficultQuestions', JSON.stringify(testQuestions));
            
            // Reload the questions
            loadDifficultQuestions();
            
            showNotification('‚úÖ ƒê√£ t·∫°o 6 c√¢u h·ªèi kh√≥ m·∫´u ƒë·ªÉ test!', 'info');
        }
        
        // Tab switching function
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab content
            const selectedTab = document.getElementById(tabName + 'Tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // Add active class to selected tab button using its ID
            const selectedButton = document.getElementById(tabName + 'TabBtn');
            if (selectedButton) {
                selectedButton.classList.add('active');
            }
            
            // If switching to quiz tab, check if there are difficult questions
            if (tabName === 'quiz') {
                const difficultQuestions = getQuestionsFromStorage('difficultQuestions');
                // Only show notification if there are no difficult questions AND a custom quiz isn't about to start.
                if (difficultQuestions.length === 0 && quizQuestions.length === 0) {
                    showNotification('Kh√¥ng c√≥ c√¢u h·ªèi kh√≥ n√†o ƒë·ªÉ l√†m quiz!', 'warning');
                }
            }
        }



         function randomizeQuestions() {
             const questions = getQuestionsFromStorage('difficultQuestions');
             const filterSelect = document.getElementById('filterSelect');
             const filterValue = filterSelect ? filterSelect.value : 'all';

             if (questions.length === 0) {
                 showNotification('Kh√¥ng c√≥ c√¢u h·ªèi n√†o ƒë·ªÉ s·∫Øp x·∫øp ng·∫´u nhi√™n', 'warning');
                 return;
             }

             let questionsToShuffle = [];
             let otherQuestions = [];

             if (filterValue === 'all') {
                 questionsToShuffle = [...questions];
             } else {
                 const [start, end] = filterValue.split('-').map(num => parseInt(num));
                 questionsToShuffle = questions.filter(question => {
                     const questionNum = parseInt(question.questionNumber);
                     return questionNum >= start && questionNum <= end;
                 });
                 otherQuestions = questions.filter(question => {
                     const questionNum = parseInt(question.questionNumber);
                     return questionNum < start || questionNum > end;
                 });
             }

             if (questionsToShuffle.length === 0) {
                 showNotification('Kh√¥ng c√≥ c√¢u h·ªèi n√†o trong b·ªô l·ªçc hi·ªán t·∫°i ƒë·ªÉ s·∫Øp x·∫øp', 'warning');
                 return;
             }

             // Fisher-Yates shuffle algorithm for random sorting
             for (let i = questionsToShuffle.length - 1; i > 0; i--) {
                 const j = Math.floor(Math.random() * (i + 1));
                 [questionsToShuffle[i], questionsToShuffle[j]] = [questionsToShuffle[j], questionsToShuffle[i]];
             }

             const finalQuestions = [...questionsToShuffle, ...otherQuestions];
             
             // Update localStorage with shuffled questions
             localStorage.setItem('difficultQuestions', JSON.stringify(finalQuestions));
             loadDifficultQuestions(); // Re-render the list with shuffled data
             
             showNotification('ƒê√£ s·∫Øp x·∫øp c√¢u h·ªèi ng·∫´u nhi√™n', 'info');
         }

         function filterDifficultQuestions() {
             const filterSelect = document.getElementById('filterSelect');
             const filterValue = filterSelect.value;
             
             // Store filter preference
             localStorage.setItem('difficultQuestionsFilter', filterValue);
             
             // Reload questions with filter
             loadDifficultQuestions();
             
             // Show notification about filter change
             if (filterValue === 'all') {
                 showNotification('ƒê√£ hi·ªÉn th·ªã t·∫•t c·∫£ c√¢u h·ªèi kh√≥', 'info');
             } else {
                 // Get the display name for the range
                 const rangeDisplayName = getRangeDisplayName(filterValue);
                 showNotification(`ƒê√£ l·ªçc theo: ${rangeDisplayName}`, 'info');
             }
         }
        
        // Load questions when page loads
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('Page loaded, initializing...');
            
            // Load quiz data first
            const quizDataLoaded = await loadQuizData();
            
            // Check for a custom quiz
            const customQuizQuestions = getQuestionsFromStorage('customQuizQuestions');
            if (customQuizQuestions && customQuizQuestions.length > 0) {
                // Clear the custom quiz data from storage immediately
                localStorage.removeItem('customQuizQuestions');

                // Switch to the quiz tab and start the quiz
                switchTab('quiz');
                startQuiz(customQuizQuestions);

                // We still load the difficult questions list for the other tab
                loadDifficultQuestions();
            } else {
                // Normal operation: restore filter and load difficult questions list
                const savedFilter = localStorage.getItem('difficultQuestionsFilter');
                if (savedFilter) {
                    const filterSelect = document.getElementById('filterSelect');
                    if (filterSelect) filterSelect.value = savedFilter;
                }
                loadDifficultQuestions();
            }
            
            // Debug: Log ra d·ªØ li·ªáu ƒë·ªÉ ki·ªÉm tra
            const questions = getQuestionsFromStorage('difficultQuestions');
            console.log('Difficult questions data:', questions);
            
            // Always show tabs, quiz mode is now in its own tab
            console.log('Tabs initialized');
        });
    </script>
    <script src="dark-mode.js"></script>
</body>
</html> 